<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="style.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Hack Camp 1.0</title>
</head>

<body>
    <div id="bgwrap">
        <div class="pageWrap">
            <section id="canYou">
                <h1 class="h1 anim">Can you say no to...</h1>
                <div id="colab" class="oct">
                    <img src="images/colab.png" alt="People collaborating together" class="anim">
                    <h2 class="h3 anim">A chance to collaborate and create something wonderful!</h2>
                </div>
                <div id="fun" class="oct">
                    <img src="images/fun.png" alt="People with smiles on their faces" class="anim">
                    <h2 class="h3 anim">A fun weekend with innovators like you</h2>
                </div>
                <div id="food" class="oct">
                    <img src="images/food.png" alt="Food" class="anim">
                    <h2 class="h3 anim">Delicious food</h2>
                </div>
            </section>
            <section id="lot">
                <h2 class="h2 anim">and</h2>
                <h2 class="h2 anim">a</h2>
                <h2 class="h2 anim">loooootta</h2>
            </section>
            <section id="swags" class="oct">
                <h2 class="h2 anim">SWAGS!</h2>
                <img src="images/swags.png" alt="Swags" class="anim">
            </section>
            <section id="logo">
                <img src="images/logo.svg" alt="Hack Camp Logo" class="anim">
                <h1 class="h2 anim">Hack Camp 1.0</h1>
                <p class="h3 anim">1-2 Feb 2020</p>
                <p class="h3 anim">Integrated Startup Complex Kalamassery</p>
            </section>
        </div>
    </div>
    <div class="pageWrap">
        <section id="yesNo">
            <h3 class="h2 anim">So can you?</h3>
            <div id="buttons" class="anim">
                <button id="no">No,<br><span>sign me up!</span></button><button id="yes">Yes, I can say no because...</button>
            </div>
        </section>
        <section id="org">
            <h3 class="h2 anim">Organized by</h3>
            <div class="orgs">
                <a href="https://hackclub.com"><img src="images/hackclub.svg" alt="Hack Club Logo" class="anim"></a>
            </div>
            <div class="orgs">
                <a href="https://mlh.io"><img src="images/mlh.svg" alt="MLH Logo" class="anim"></a>
            </div>
        </section>
        <div id="email">
            <p id="close">Close</p>
            <p class="h2" id="yesNoTitle"></p>
            <form id="form" onsubmit="return false">
                <input type="email" name="email" id="emailInput" placeholder="Enter your email" required><br>
                <textarea name="feedback" id="feedback" rows="6" placeholder="" required></textarea><br><input type="submit" id="submitButton">
            </form>
        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-firestore.js"></script>
    <script>
        let firebaseConfig = {
            apiKey: "AIzaSyC_n4PXfgiR4Feli0wNFvDYWAQ2DDgiFkk",
            authDomain: "hackcamp1.firebaseapp.com",
            databaseURL: "https://hackcamp1.firebaseio.com",
            projectId: "hackcamp1",
            storageBucket: "hackcamp1.appspot.com",
            messagingSenderId: "578516146778",
            appId: "1:578516146778:web:2b39580c3b4465fb281663"
        }
        firebase.initializeApp(firebaseConfig)
        let db = firebase.firestore()
        let animate = () => {
            document.querySelectorAll('.anim').forEach(e => {
                if ((e.offsetTop - window.innerHeight / 1.2) < (window.scrollY || window.pageYOffset)) {
                    e.classList.add('animate')
                }
            })
        }
        let reveal = (e) => {
            document.getElementById('emailInput').style.display = 'inline-block'
            document.getElementById('feedback').style.display = 'inline-block'
            document.getElementById('submitButton').style.display = 'inline-block'
            document.getElementById('yesNoTitle').innerText = e == 0 ? 'Let\'s do this!' : 'What can we do to change your mind?'
            document.getElementById('feedback').setAttribute('placeholder', e == 0 ? 'Any message for us?' : 'Tell us why you\'re not interested and we\'ll try our best to make this event to your liking.')
            document.getElementById('form').addEventListener('submit', () => {
                sendData(e)
            })
            document.getElementById('email').classList.add('reveal')
            document.querySelector('html').classList.add('noScroll')
            document.querySelector('body').classList.add('noScroll')
        }
        let close = () => {
            document.getElementById('email').classList.remove('reveal')
            document.querySelector('html').classList.remove('noScroll')
            document.querySelector('body').classList.remove('noScroll')
        }
        let sendData = (e) => {
            document.getElementById('submitButton').innerText += '...'
            if (e === 0) {
                db.collection("participants").add({
                    email: document.getElementById('emailInput').value,
                    feedback: document.getElementById('feedback').value
                }).then(function (docRef) {
                    document.getElementById('yesNoTitle').innerText = 'Woohoo! We\'ll get in touch with you soon.'
                    document.getElementById('emailInput').style.display = 'none'
                    document.getElementById('feedback').style.display = 'none'
                    document.getElementById('submitButton').style.display = 'none'
                }).catch(function (error) {
                    document.getElementById('yesNoTitle').innerText = 'Oops. There was some error in sending your data. Please try again later.'
                    document.getElementById('emailInput').style.display = 'none'
                    document.getElementById('feedback').style.display = 'none'
                    document.getElementById('submitButton').style.display = 'none'
                })
            }
            else {
                db.collection("feedback").add({
                    email: document.getElementById('emailInput').value,
                    feedback: document.getElementById('feedback').value
                }).then(function (docRef) {
                    document.getElementById('yesNoTitle').innerText = 'We\'ll get in touch with you soon.'
                    document.getElementById('emailInput').style.display = 'none'
                    document.getElementById('feedback').style.display = 'none'
                    document.getElementById('submitButton').style.display = 'none'
                }).catch(function (error) {
                    document.getElementById('yesNoTitle').innerText = 'Oops. There was some error in sending your data. Please try again later'
                    document.getElementById('emailInput').style.display = 'none'
                    document.getElementById('feedback').style.display = 'none'
                    document.getElementById('submitButton').style.display = 'none'
                })
            }
        }
        animate()
        window.onscroll = animate
        window.onresize = animate
        document.querySelectorAll('#buttons button').forEach((e, i) => {
            e.addEventListener('click', () => reveal(i))
        })
        document.getElementById('close').addEventListener('click', () => close())
    </script>
</body>

</html>